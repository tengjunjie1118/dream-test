// data.js - é€»è¾‘å†…æ ¸ (ä¸¥æ ¼æ ¡éªŒç‰ˆ)

const SUPABASE_URL = 'https://mfyvaxphxabtnjrjucip.supabase.co';
const SUPABASE_KEY = 'sb_publishable_Yv8fSmqX64lknihxI-uaYA_fSedU6JW';
let db;

try {
    if (typeof supabase !== 'undefined') {
        db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
    }
} catch (e) {
    console.warn("Supabase init skipped");
}

// 1. å®Œæ•´é¢˜ç›®æ•°æ®åº“ (45é¢˜ï¼Œæ¯é¢˜åŒ…å«ç‰¹å®šé€‰é¡¹)
const quizData = [
    // --- 1. æƒ…æ„Ÿå…±æŒ¯ (1-9) ---
    {
        q: "1. å½“TAæƒ…ç»ªä½è½æ—¶ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ",
        options: [
            { text: "A. ç«‹å³æ„Ÿå—åˆ°å¹¶ç”¨è¡ŒåŠ¨æ”¯æŒï¼Œæ— éœ€è¨€è¯­", score: 4 },
            { text: "B. è¯¢é—®å¹¶é¼“åŠ±TAè¡¨è¾¾ï¼Œæä¾›å®‰æ…°", score: 3 },
            { text: "C. å°Šé‡TAçš„ç‹¬å¤„ç©ºé—´ï¼Œç­‰å¾…TAå¼€å£", score: 2 },
            { text: "D. å¯èƒ½ä¼šå¿½ç•¥ï¼Œç›´åˆ°TAæ˜ç¡®å‘ŠçŸ¥", score: 1 }
        ]
    },
    {
        q: "2. ä½ å¦‚ä½•çœ‹å¾…TAä¸ä½ åˆ†äº«çš„å¤æ‚æƒ…ç»ªï¼Ÿ",
        options: [
            { text: "A. ä¿æŒå®Œå…¨æ¥çº³ï¼Œå¹¶èƒ½å…±æƒ…å…¶æ·±å±‚åŸå› ", score: 4 },
            { text: "B. è®¤çœŸå€¾å¬ï¼Œå¹¶åŠªåŠ›ç†è§£TAçš„æ„Ÿå—", score: 3 },
            { text: "C. æœ‰æ—¶ä¼šè§‰å¾—æœ‰ç‚¹æ²‰é‡ï¼Œä½†ä»ä¼šå¬å®Œ", score: 2 },
            { text: "D. è®¤ä¸ºåº”è¯¥ç†æ€§è§£å†³ï¼Œä¸å¤ªç†è§£æƒ…ç»ªæœ¬èº«", score: 1 }
        ]
    },
    {
        q: "3. åœ¨ä½ ä»¬å‘ç”Ÿå°æ‘©æ“¦åï¼Œä½ çš„æƒ…ç»ªä¿®å¤é€Ÿåº¦ï¼Ÿ",
        options: [
            { text: "A. åŒæ–¹éƒ½èƒ½å¾ˆå¿«è‡ªæˆ‘è°ƒèŠ‚ï¼Œå¹¶ä¸»åŠ¨å’Œè§£", score: 4 },
            { text: "B. åªè¦TAç¤ºå¥½ï¼Œæˆ‘èƒ½è¿…é€Ÿæ”¾ä¸‹è´Ÿé¢æƒ…ç»ª", score: 3 },
            { text: "C. éœ€ç­‰ä¸€æ®µæ—¶é—´å†·é™ï¼Œä½†æœ€ç»ˆä¼šä¿®å¤", score: 2 },
            { text: "D. å¯èƒ½ä¼šæŒç»­ä¸€æ®µæ—¶é—´ï¼Œå½±å“åˆ°åç»­äº’åŠ¨", score: 1 }
        ]
    },
    {
        q: "4. å…³äºå½¼æ­¤æƒ…æ„Ÿä¸Šçš„â€œå®‰å…¨è¯â€æˆ–â€œç¦åŒºâ€ï¼Ÿ",
        options: [
            { text: "A. åŒæ–¹éƒ½å¿ƒçŸ¥è‚šæ˜ï¼Œå¹¶é»˜å¥‘åœ°é¿å¼€", score: 4 },
            { text: "B. æœ‰ä¸€äº›äº†è§£ï¼Œä½†å¶å°”è¿˜ä¼šä¸å°å¿ƒè§¦ç¢°", score: 3 },
            { text: "C. éƒ½æ˜¯åœ¨è§¦ç¢°åæ‰æ„è¯†åˆ°å¹¶è¿›è¡Œè°ƒæ•´", score: 2 },
            { text: "D. ç¼ºä¹æ˜ç¡®çš„ç•Œé™ï¼Œå®¹æ˜“å¼•å‘è¯¯è§£", score: 1 }
        ]
    },
    {
        q: "5. ä½ åœ¨å…¬å¼€åœºåˆè¡¨è¾¾å¯¹TAçš„çˆ±æ„æˆ–æƒ…æ„Ÿæ”¯æŒæ—¶ï¼Ÿ",
        options: [
            { text: "A. æ„Ÿåˆ°è‡ªç„¶ä¸”å¿…è¦ï¼Œè¿™æ˜¯æˆ‘ä»¬ç›¸å¤„çš„ä¸€éƒ¨åˆ†", score: 4 },
            { text: "B. å¶å°”ä¸ºä¹‹ï¼Œä½†é€šå¸¸æ›´å€¾å‘äºç§ä¸‹è¡¨è¾¾", score: 3 },
            { text: "C. æ„Ÿåˆ°ç•¥å¾®ä¸é€‚ï¼Œæ›´å–œæ¬¢å«è“„å†…æ•›çš„æ–¹å¼", score: 2 },
            { text: "D. å¾ˆå°‘ä¸»åŠ¨è¡¨è¾¾ï¼Œè§‰å¾—ä¸å¤ªé‡è¦", score: 1 }
        ]
    },
    {
        q: "6. å½“ä½ æ„Ÿåˆ°æåº¦å…´å¥‹æˆ–æ‚²ä¼¤æ—¶ï¼ŒTAçš„å›åº”é€šå¸¸æ˜¯ï¼Ÿ",
        options: [
            { text: "A. ç¬é—´æ•æ‰å¹¶ä¸æˆ‘åŒé¢‘ï¼Œååº”å¼ºåº¦ç›¸è¿‘", score: 4 },
            { text: "B. èƒ½å¤ŸåŠæ—¶å›åº”å¹¶æä¾›æ‰€éœ€çš„æƒ…æ„Ÿæ”¯æŒ", score: 3 },
            { text: "C. ååº”ä¼šæ…¢åŠæ‹ï¼Œéœ€è¦æˆ‘ä¸»åŠ¨è¯´æ˜æƒ…å†µ", score: 2 },
            { text: "D. ååº”æ¯”è¾ƒå¹³æ·¡æˆ–ä¸ç†è§£æˆ‘çš„å¼ºçƒˆæƒ…ç»ª", score: 1 }
        ]
    },
    {
        q: "7. ä½ è§‰å¾—TAåœ¨å¤šå¤§ç¨‹åº¦ä¸Šæ˜¯ä½ çš„â€œæƒ…ç»ªé¿é£æ¸¯â€ï¼Ÿ",
        options: [
            { text: "A. 100%ï¼Œæ— è®ºå‘ç”Ÿä»€ä¹ˆéƒ½ä¼šæ˜¯æˆ‘çš„é¦–é€‰", score: 4 },
            { text: "B. 80%ï¼Œå¤§éƒ¨åˆ†æ—¶å€™éƒ½ä¼šå‘TAå¯»æ±‚å®‰æ…°", score: 3 },
            { text: "C. 50%ï¼Œåªåœ¨éå¸¸é‡è¦æˆ–ç´§æ€¥æ—¶æ‰ä¼šæ‰¾TA", score: 2 },
            { text: "D. 20%ï¼Œæˆ‘æ›´å€¾å‘äºè‡ªå·±å¤„ç†æƒ…ç»ªé—®é¢˜", score: 1 }
        ]
    },
    {
        q: "8. ä½ ä»¬å¯¹å½¼æ­¤çš„â€œæƒ…ç»ªè´¦æˆ·â€æŠ•èµ„æƒ…å†µæ˜¯ï¼Ÿ",
        options: [
            { text: "A. æŒç»­ä¸”å¤§é‡åœ°å­˜å…¥çˆ±æ„ä¸å–„æ„", score: 4 },
            { text: "B. ç»å¸¸æŠ•å…¥ï¼Œå¶å°”ä¹Ÿä¼šå› å¿™ç¢Œè€Œå¿½ç•¥", score: 3 },
            { text: "C. ç»´æŒåœ¨åŸºæœ¬å¹³è¡¡ï¼Œä½†å¾ˆå°‘æœ‰è¶…é¢æƒŠå–œ", score: 2 },
            { text: "D. å¯èƒ½ä¼šå› ä¸ºç–å¿½æˆ–çŸ›ç›¾è€Œå‡ºç°â€œé€æ”¯â€", score: 1 }
        ]
    },
    {
        q: "9. æè¿°ä¸€ä¸‹ä½ ä»¬æƒ…æ„Ÿäº¤æµä¸­æœ€å¸¸å‡ºç°çš„æ¨¡å¼ï¼Ÿ",
        options: [
            { text: "A. æ— ç¼è¿æ¥çš„å¿ƒçµå¯¹è¯ï¼Œå½¼æ­¤å¿ƒç…§ä¸å®£", score: 4 },
            { text: "B. å¦è¯šæ¸…æ™°çš„è¯­è¨€è¡¨è¾¾ï¼Œç¡®ä¿ç†è§£æ— è¯¯", score: 3 },
            { text: "C. æ›´å¤šä¾é è‚¢ä½“è¯­è¨€å’Œæ—¥å¸¸äº’åŠ¨æ¥ä¼ è¾¾", score: 2 },
            { text: "D. å¾€å¾€æ˜¯å•æ–¹é¢è¾“å‡ºï¼Œå¦ä¸€æ–¹è¢«åŠ¨æ¥æ”¶", score: 1 }
        ]
    },

    // --- 2. æ—¥å¸¸ä»ªå¼ (10-18) ---
    {
        q: "10. ä½ ä»¬çš„ä½œæ¯ä¹ æƒ¯åŒæ­¥ç¨‹åº¦å¦‚ä½•ï¼Ÿ",
        options: [
            { text: "A. å³ä½¿æœ‰å·®å¼‚ï¼Œä¹Ÿèƒ½å®Œç¾é…åˆï¼Œäº’ä¸å¹²æ‰°", score: 4 },
            { text: "B. åŸºæœ¬åŒæ­¥ï¼Œå¶å°”éœ€è¦ä¸€æ–¹è°ƒæ•´é€‚åº”", score: 3 },
            { text: "C. å·®å¼‚è¾ƒå¤§ï¼Œä½†å„è‡ªéƒ½èƒ½ç‹¬ç«‹å®Œæˆæ—¥å¸¸", score: 2 },
            { text: "D. å·®å¼‚æ˜¾è‘—ï¼Œå¸¸å› æ­¤å½±å“åˆ°å…±åŒè®¡åˆ’", score: 1 }
        ]
    },
    {
        q: "11. å…³äºå®¶ä¸­ç‰©å“æ‘†æ”¾æˆ–ç©ºé—´å…±äº«ï¼Œä½ ä»¬æ˜¯ï¼Ÿ",
        options: [
            { text: "A. å…±åŒåˆ›é€ çš„èˆ’é€‚ç©ºé—´ï¼Œç‰©å“æ‘†æ”¾é»˜å¥‘ä¸€è‡´", score: 4 },
            { text: "B. åˆ’åˆ†æ¸…æ™°çš„ç§äººåŒºåŸŸï¼Œå…¬å…±åŒºåŸŸæœ‰å…±è¯†", score: 3 },
            { text: "C. ç»å¸¸éœ€è¦åè°ƒæ•´ç†ï¼Œä»¥å…é€ æˆæ··ä¹±", score: 2 },
            { text: "D. å„è‡ªä¸ºæ”¿ï¼Œéš¾ä»¥å½¢æˆç»Ÿä¸€çš„é£æ ¼", score: 1 }
        ]
    },
    {
        q: "12. ä½ ä»¬æ˜¯å¦æœ‰ä¸“å±çš„â€œå°ä»ªå¼â€æˆ–â€œæš—å·â€ï¼Ÿ",
        options: [
            { text: "A. æœ‰å¤šä¸ªåªæœ‰å½¼æ­¤æ‡‚å¾—çš„é»˜å¥‘ï¼Œå¹¶å¸¸ä½¿ç”¨", score: 4 },
            { text: "B. æœ‰ä¸€ä¸¤ä¸ªå›ºå®šçš„å°ä¹ æƒ¯ï¼Œå¸¦æ¥äº²å¯†æ„Ÿ", score: 3 },
            { text: "C. å¶å°”ä¼šå³å…´åˆ›é€ ï¼Œä½†æ²¡æœ‰å›ºå®šä¸‹æ¥", score: 2 },
            { text: "D. åŸºæœ¬æ²¡æœ‰ï¼Œæ—¥å¸¸äº’åŠ¨éå¸¸ç›´æ¥", score: 1 }
        ]
    },
    {
        q: "13. å¯¹äºé¥®é£Ÿåå¥½æˆ–ç”Ÿæ´»çäº‹ä¸Šçš„å·®å¼‚ï¼Œä½ ä»¬å¦‚ä½•å¤„ç†ï¼Ÿ",
        options: [
            { text: "A. äº’ç›¸è¿å°±ï¼Œå°†å·®å¼‚è§†ä¸ºäº’ç›¸å–æ‚¦çš„æœºä¼š", score: 4 },
            { text: "B. è½®æµåšä¸»ï¼Œç¡®ä¿åŒæ–¹çš„å–œå¥½éƒ½èƒ½æ»¡è¶³", score: 3 },
            { text: "C. é‡‡å–æŠ˜è¡·æ–¹æ¡ˆï¼Œä½†æœ‰æ—¶ä¼šæ„Ÿåˆ°ä¸æ»¡è¶³", score: 2 },
            { text: "D. å¤šæ•°æ—¶å€™å„è‡ªè§£å†³ï¼Œå¾ˆå°‘å¦¥å", score: 1 }
        ]
    },
    {
        q: "14. åœ¨è®¡åˆ’ä¸€ä¸ªå…±åŒçš„ä¼‘æ¯æ—¥æ´»åŠ¨æ—¶ï¼Œä½ ä»¬é€šå¸¸æ˜¯ï¼Ÿ",
        options: [
            { text: "A. æƒ³æ³•è‡ªç„¶ä¸€è‡´ï¼Œå¾ˆå¿«å°±èƒ½ç¡®å®šä¸‹æ¥", score: 4 },
            { text: "B. è½»æ¾åœ°è®¨è®ºï¼Œèƒ½åœ¨çŸ­æ—¶é—´å†…è¾¾æˆå…±è¯†", score: 3 },
            { text: "C. éœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´è¯´æœæˆ–è®¨è®ºç»†èŠ‚", score: 2 },
            { text: "D. å¾ˆéš¾è¾¾æˆä¸€è‡´ï¼Œå¸¸å› ä¸ºæ„è§ä¸åˆè€Œæç½®", score: 1 }
        ]
    },
    {
        q: "15. ä½ å¯¹TAçš„æ—¥å¸¸ä¹ æƒ¯ï¼ˆå¦‚æ”¶æ‹¾æ–¹å¼ã€ç¡å‰ä¹ æƒ¯ï¼‰çš„æ¥å—åº¦æ˜¯ï¼Ÿ",
        options: [
            { text: "A. 100%æ¥çº³ï¼Œç”šè‡³æ„Ÿåˆ°å¯çˆ±æˆ–èƒ½è¢«å¯å‘", score: 4 },
            { text: "B. 80%ï¼Œèƒ½æ¥å—å¤§å¤šæ•°ï¼Œå°ç‘•ç–µå¯ä»¥å¿½ç•¥", score: 3 },
            { text: "C. 50%ï¼Œæœ‰äº›ä¹ æƒ¯éœ€è¦æˆ‘åŠªåŠ›å»é€‚åº”", score: 2 },
            { text: "D. 20%ï¼Œæœ‰äº›ä¹ æƒ¯è®©æˆ‘æ„Ÿåˆ°å›°æ‰°å’Œä¸é€‚", score: 1 }
        ]
    },
    {
        q: "16. ä½ è®¤ä¸ºä½ ä»¬åœ¨ç”Ÿæ´»å“å‘³æˆ–å®¡ç¾ä¸Šçš„å¥‘åˆåº¦ï¼Ÿ",
        options: [
            { text: "A. æåº¦ç›¸ä¼¼ï¼Œå¯¹ç¾å¥½äº‹ç‰©çš„ç†è§£åŸºæœ¬ä¸€è‡´", score: 4 },
            { text: "B. å¤§è‡´ç›¸åŒï¼Œèƒ½åœ¨å¤§éƒ¨åˆ†é—®é¢˜ä¸Šä¿æŒç»Ÿä¸€", score: 3 },
            { text: "C. å·®å¼‚æ˜æ˜¾ï¼Œä½†èƒ½å¤Ÿäº’ç›¸æ¬£èµå½¼æ­¤çš„é£æ ¼", score: 2 },
            { text: "D. å·®å¼‚å¾ˆå¤§ï¼Œå¸¸è§‰å¾—å¯¹æ–¹çš„å“å‘³éš¾ä»¥ç†è§£", score: 1 }
        ]
    },
    {
        q: "17. ä½ ä»¬ä¼šå¦‚ä½•å¯¹å¾…å½¼æ­¤çš„â€œä¸“å±æ—¶åˆ»â€ï¼ˆå¦‚å·¥ä½œã€çˆ±å¥½ï¼‰ï¼Ÿ",
        options: [
            { text: "A. ä¸»åŠ¨åˆ›é€ æ”¯æŒç¯å¢ƒï¼Œç»ä¸æ‰“æ‰°ä¸”å……æ»¡é¼“åŠ±", score: 4 },
            { text: "B. ä¿æŒå°Šé‡ï¼Œä½†åœ¨TAå®Œæˆåå¸Œæœ›ç«‹å³åˆ†äº«", score: 3 },
            { text: "C. ä¼šå°Šé‡ï¼Œä½†æœ‰æ—¶ä¼šå› ä¸ºæ„Ÿåˆ°æ— èŠè€Œæ‰“æ‰°", score: 2 },
            { text: "D. ç»å¸¸ä¼šå› ä¸ºè‡ªå·±çš„éœ€æ±‚è€Œå¿½è§†TAçš„ä¸“å±æ—¶åˆ»", score: 1 }
        ]
    },
    {
        q: "18. ä½ ä»¬çš„å±…å®¶â€œå™ªéŸ³â€ç¨‹åº¦ï¼ˆå¦‚ç”µè§†éŸ³é‡ã€éŸ³ä¹é€‰æ‹©ï¼‰ï¼Ÿ",
        options: [
            { text: "A. å®Œç¾åœ°ç›¸äº’é€‚åº”ï¼Œæ— éœ€æé†’å°±èƒ½è°ƒæ•´", score: 4 },
            { text: "B. æœ‰ä¸€ä¸ªä¸æˆæ–‡çš„è§„å®šï¼Œä¸€èˆ¬èƒ½éµå®ˆ", score: 3 },
            { text: "C. å¶å°”éœ€è¦æé†’å¯¹æ–¹è°ƒæ•´ï¼Œæ‰èƒ½ä¿æŒèˆ’é€‚", score: 2 },
            { text: "D. ç»å¸¸å› æ­¤å‘ç”Ÿäº‰æ‰§æˆ–æ„Ÿåˆ°è¢«å¹²æ‰°", score: 1 }
        ]
    },

    // --- 3. æ²Ÿé€šæ·±åº¦ (19-27) ---
    {
        q: "19. ä½ ä»¬åˆ†äº«â€œæœªæ¥è§„åˆ’â€æˆ–â€œäººç”Ÿç›®æ ‡â€çš„é¢‘ç‡ï¼Ÿ",
        options: [
            { text: "A. ç»å¸¸æ·±å…¥è®¨è®ºï¼Œå½¼æ­¤çš„æ¢¦æƒ³èä¸ºä¸€ä½“", score: 4 },
            { text: "B. å¶å°”ä¼šèŠï¼ŒTAå¯¹æˆ‘çš„ç›®æ ‡æœ‰æ¸…æ™°äº†è§£", score: 3 },
            { text: "C. åªæ˜¯æ¦‚è¿°ï¼Œå¾ˆå°‘æ¶‰åŠç»†èŠ‚æˆ–æ·±å±‚åŠ¨æœº", score: 2 },
            { text: "D. å¾ˆå°‘æ¶‰åŠï¼Œè§‰å¾—é‚£æ˜¯ç§äººçš„äº‹æƒ…", score: 1 }
        ]
    },
    {
        q: "20. ä½ å‘TAå€¾è¯‰ç§˜å¯†æˆ–å†…å¿ƒè„†å¼±æ—¶çš„æ„Ÿå—æ˜¯ï¼Ÿ",
        options: [
            { text: "A. å®Œå…¨çš„å®‰å…¨å’Œä¿¡ä»»ï¼ŒçŸ¥é“TAä¼šæ¸©æŸ”å®ˆæŠ¤", score: 4 },
            { text: "B. æ„Ÿè§‰å®‰å…¨ï¼Œç›¸ä¿¡TAä¸ä¼šè½»æ˜“è¯„åˆ¤", score: 3 },
            { text: "C. ç•¥æœ‰ä¿ç•™ï¼Œæ‹…å¿ƒTAå¯èƒ½ä¼šè¯¯è§£æˆ–ä¸å®‰", score: 2 },
            { text: "D. æœ‰å¾ˆå¼ºçš„æˆ’å¿ƒï¼Œå¾ˆå°‘é€éœ²çœŸå®çš„è‡ªå·±", score: 1 }
        ]
    },
    {
        q: "21. TAå‘ä½ è¡¨è¾¾å›°éš¾æ—¶ï¼Œä½ çš„å€¾å¬æ–¹å¼æ˜¯ï¼Ÿ",
        options: [
            { text: "A. ç§¯æå€¾å¬ï¼Œèƒ½æ•æ‰æ½œå°è¯å¹¶ç»™å‡ºçœŸè¯šåé¦ˆ", score: 4 },
            { text: "B. ä¿æŒä¸“æ³¨å¹¶è¡¨è¾¾ç†è§£ï¼Œç»™äºˆé™ªä¼´", score: 3 },
            { text: "C. ä¸»è¦æ˜¯ç­‰å¾…TAè¯´å®Œï¼Œç„¶åç»™å‡ºè‡ªå·±çš„å»ºè®®", score: 2 },
            { text: "D. å¯èƒ½ä¼šæ‰“æ–­æˆ–æ€¥äºç»™å‡ºè§£å†³æ–¹æ³•", score: 1 }
        ]
    },
    {
        q: "22. ä½ ä»¬åœ¨æ²Ÿé€šä¸­å¯¹â€œæ²‰é»˜â€çš„ç†è§£æ˜¯ï¼Ÿ",
        options: [
            { text: "A. èˆ’é€‚çš„ç•™ç™½æˆ–æ— å£°çš„äº¤æµï¼Œä¸æ„Ÿåˆ°å‹åŠ›", score: 4 },
            { text: "B. èƒ½å¤Ÿæ¥å—ï¼ŒçŸ¥é“å¯¹æ–¹åªæ˜¯åœ¨æ€è€ƒæˆ–æ”¾ç©º", score: 3 },
            { text: "C. å¶å°”ä¼šè§‰å¾—ä¸è‡ªåœ¨ï¼Œæƒ³æ‰¾è¯é¢˜æ‰“ç ´", score: 2 },
            { text: "D. è®¤ä¸ºæ˜¯ä¸æ»¡æˆ–å¿ƒäº‹é‡é‡çš„ä¿¡å·ï¼Œæ„Ÿåˆ°ç„¦è™‘", score: 1 }
        ]
    },
    {
        q: "23. ä½ ä»¬è®¨è®ºæ•æ„Ÿæˆ–ä¸¥è‚ƒè¯é¢˜æ—¶çš„æ•ˆæœå¦‚ä½•ï¼Ÿ",
        options: [
            { text: "A. æ— è®ºå¤šéš¾éƒ½èƒ½ä¿æŒå¹³é™ï¼Œå¹¶æ‰¾åˆ°æœ€ä¼˜è§£", score: 4 },
            { text: "B. èƒ½å¤Ÿç†æ€§è®¨è®ºï¼Œä½†å¶å°”ä¼šä¼´éšæƒ…ç»ªæ³¢åŠ¨", score: 3 },
            { text: "C. ç»å¸¸é¿é‡å°±è½»ï¼Œéš¾ä»¥è§¦åŠé—®é¢˜çš„æ ¸å¿ƒ", score: 2 },
            { text: "D. å¾ˆå®¹æ˜“æ¼”å˜æˆäº‰åµæˆ–å†·æˆ˜", score: 1 }
        ]
    },
    {
        q: "24. ä½ ä»¬ä¹‹é—´æ˜¯å¦å­˜åœ¨åªæœ‰å½¼æ­¤æ‰æ‡‚çš„â€œç§å¯†è¯­è¨€â€ï¼Ÿ",
        options: [
            { text: "A. è¿™ç§è¯­è¨€æ˜¯æ—¥å¸¸æ²Ÿé€šä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†", score: 4 },
            { text: "B. æœ‰ä¸€äº›å…±åŒçš„æ¢—å’Œç¬‘è¯ï¼Œå¢åŠ äº²å¯†æ„Ÿ", score: 3 },
            { text: "C. å¶å°”å¼•ç”¨ï¼Œä½†å¹¶éæ²Ÿé€šçš„ä¸»æµæ–¹å¼", score: 2 },
            { text: "D. æ²¡æœ‰ï¼Œå½¼æ­¤çš„æ²Ÿé€šæ˜¯æ ‡å‡†çš„æ—¥å¸¸ç”¨è¯­", score: 1 }
        ]
    },
    {
        q: "25. æè¿°ä¸€ä¸‹ä½ ä»¬çš„æ²Ÿé€šé£æ ¼ï¼Ÿ",
        options: [
            { text: "A. é€æ˜ã€é«˜æ•ˆä¸”å……æ»¡æƒ…ç»ªä»·å€¼", score: 4 },
            { text: "B. çœŸè¯šã€ç›´æ¥ä¸”äº’ç›¸å°Šé‡", score: 3 },
            { text: "C. å§”å©‰ã€å«è“„ï¼Œç»å¸¸éœ€è¦äº’ç›¸çŒœæµ‹", score: 2 },
            { text: "D. æ¨¡ç³Šã€è¢«åŠ¨ï¼Œä¿¡æ¯ä¼ é€’å®¹æ˜“å¤±çœŸ", score: 1 }
        ]
    },
    {
        q: "26. å½“TAçš„è¡¨è¾¾ä¸ä½ çš„è®¤çŸ¥äº§ç”Ÿå†²çªæ—¶ï¼Œä½ ä¼šï¼Ÿ",
        options: [
            { text: "A. æ·±å…¥æ¢ç©¶TAçš„è§†è§’ï¼Œäº«å—æ€ç»´ç¢°æ’", score: 4 },
            { text: "B. å…ˆæ”¾ä¸‹è‡ªå·±çš„è§‚ç‚¹ï¼Œå°è¯•ç†è§£å¯¹æ–¹çš„é€»è¾‘", score: 3 },
            { text: "C. åšæŒè‡ªå·±çš„ç«‹åœºï¼Œä½†ä¼šè¡¨è¾¾å¯¹TAçš„å°Šé‡", score: 2 },
            { text: "D. å¾ˆéš¾æ¥å—ï¼Œä¼šè¯•å›¾è¯´æœTAæ¥å—æˆ‘çš„è§‚ç‚¹", score: 1 }
        ]
    },
    {
        q: "27. åœ¨ä¸€å¤©çš„å¿™ç¢Œç»“æŸåï¼Œä½ ä»¬çš„â€œåˆ†äº«æ—¶åˆ»â€è´¨é‡æ˜¯ï¼Ÿ",
        options: [
            { text: "A. æ·±åˆ»ä¸”ä»¤äººæ”¾æ¾ï¼Œèƒ½è·å¾—ç²¾ç¥ä¸Šçš„æ»¡è¶³", score: 4 },
            { text: "B. æ„‰å¿«çš„æ—¥å¸¸åˆ†äº«ï¼Œèƒ½æ„Ÿå—åˆ°å½¼æ­¤çš„è”ç»“", score: 3 },
            { text: "C. ä¸»è¦æ˜¯ç®€çŸ­çš„é—®å€™å’Œäº‹åŠ¡æ€§äº¤æµ", score: 2 },
            { text: "D. å¸¸å¸¸å› ä¸ºç–²æƒ«æˆ–å„è‡ªå¿™ç¢Œè€Œè·³è¿‡", score: 1 }
        ]
    },

    // --- 4. å†²çªå¤„ç† (28-36) ---
    {
        q: "28. ä½ ä»¬è§£å†³äº‰æ‰§çš„å¸¸è§æ¨¡å¼æ˜¯ï¼Ÿ",
        options: [
            { text: "A. å…±åŒè§£å†³é—®é¢˜ï¼Œç¡®ä¿åŒæ–¹æ„Ÿå—éƒ½è¢«ç…§é¡¾", score: 4 },
            { text: "B. å¤šæ•°æ—¶å€™ä¸€æ–¹å…ˆè®©æ­¥ï¼Œç„¶åè¿›è¡Œæ²Ÿé€š", score: 3 },
            { text: "C. ç»å¸¸é€šè¿‡å†·å¤„ç†æˆ–è½¬ç§»è¯é¢˜æ¥å¹³æ¯", score: 2 },
            { text: "D. éš¾ä»¥è¾¾æˆä¸€è‡´ï¼Œé€šå¸¸ä»¥ä¸€æ–¹çš„å¦¥åå‘Šç»ˆ", score: 1 }
        ]
    },
    {
        q: "29. ä½ ä»¬åœ¨äº‰åµåä¼šè¿›è¡Œæƒ…ç»ªâ€œå–„åâ€å—ï¼Ÿ",
        options: [
            { text: "A. å¿…é¡»è¿›è¡Œæ·±åº¦ä¿®å¤ï¼Œç¡®ä¿æƒ…æ„Ÿæ— æ®‹ç•™", score: 4 },
            { text: "B. ä¼šä¸»åŠ¨é“æ­‰å¹¶æ‹¥æŠ±ï¼Œå¿«é€Ÿå›åˆ°äº²å¯†çŠ¶æ€", score: 3 },
            { text: "C. å¤šæ•°æ—¶å€™æ—¶é—´ä¼šå†²æ·¡ä¸€åˆ‡ï¼Œå¾ˆå°‘æ­£å¼è®¨è®º", score: 2 },
            { text: "D. å¸¸å¸¸å°†è´Ÿé¢æƒ…ç»ªå¸¦å…¥ä¸‹ä¸€é˜¶æ®µçš„äº’åŠ¨", score: 1 }
        ]
    },
    {
        q: "30. ä½ è®¤ä¸ºä½ ä»¬å¤„ç†å†²çªçš„æ•ˆç‡æ˜¯ï¼Ÿ",
        options: [
            { text: "A. æ€»æ˜¯èƒ½å¿«é€Ÿæ‰¾åˆ°é—®é¢˜çš„æ ¸å¿ƒå¹¶è§£å†³", score: 4 },
            { text: "B. ç»è¿‡è®¨è®ºåï¼Œå¤šæ•°é—®é¢˜èƒ½å¾—åˆ°è§£å†³", score: 3 },
            { text: "C. è§£å†³è¿‡ç¨‹æ¯”è¾ƒæ¼«é•¿ï¼Œå®¹æ˜“åå¤æåŠæ—§äº‹", score: 2 },
            { text: "D. å¾€å¾€ç»•æ¥ç»•å»ï¼Œé—®é¢˜å¾—ä¸åˆ°æ ¹æœ¬è§£å†³", score: 1 }
        ]
    },
    {
        q: "31. åœ¨è®¾ç½®â€œä¸ªäººè¾¹ç•Œâ€æ—¶ï¼Œä½ ä»¬çš„æ€åº¦æ˜¯ï¼Ÿ",
        options: [
            { text: "A. è¾¹ç•Œæ¸…æ™°ä¸”äº’ç›¸å°Šé‡ï¼Œæ— éœ€é‡å¤å¼ºè°ƒ", score: 4 },
            { text: "B. è¾¹ç•Œå¤§è‡´æ¸…æ¥šï¼Œä½†åœ¨æƒ…ç»ªæ¿€åŠ¨æ—¶ä¼šè§¦ç¢°", score: 3 },
            { text: "C. éœ€è¦åå¤æ²Ÿé€šæ‰èƒ½æ˜ç¡®è¾¹ç•Œå’Œåº•çº¿", score: 2 },
            { text: "D. è¾¹ç•Œæ¨¡ç³Šï¼Œç»å¸¸æ„Ÿåˆ°è‡ªå·±çš„ç©ºé—´è¢«ä¾µçŠ¯", score: 1 }
        ]
    },
    {
        q: "32. å½“ä½ ä»¬äº‰æ‰§ä¸ä¸‹æ—¶ï¼Œä½ æˆ–TAä¼šå€¾å‘äºé‡‡å–çš„è¡ŒåŠ¨æ˜¯ï¼Ÿ",
        options: [
            { text: "A. ç«‹å³æš‚åœï¼Œçº¦å®šå†·é™åå†è¿›è¡Œâ€œå»ºè®¾æ€§â€æ²Ÿé€š", score: 4 },
            { text: "B. è¡¨è¾¾è‡ªå·±çš„æƒ…ç»ªï¼Œä½†ä¼šåŠªåŠ›æ§åˆ¶éŸ³é‡å’Œæªè¾", score: 3 },
            { text: "C. é€‰æ‹©é€ƒé¿æˆ–æ²‰é»˜ï¼Œé¿å…æ­£é¢å†²çªå‡çº§", score: 2 },
            { text: "D. ä½¿ç”¨è¨€è¯­æ”»å‡»æˆ–æŒ‡è´£ï¼Œè¯•å›¾å‹å€’å¯¹æ–¹", score: 1 }
        ]
    },
    {
        q: "33. ä½ ä»¬æ˜¯å¦å°†å†²çªè§†ä¸ºâ€œå¢è¿›äº†è§£â€çš„æœºä¼šï¼Ÿ",
        options: [
            { text: "A. æ˜¯çš„ï¼Œæ¯æ¬¡å†²çªåå…³ç³»éƒ½ä¼šæ›´æ·±ä¸€æ­¥", score: 4 },
            { text: "B. æœ‰æ—¶æ˜¯ï¼Œä¼šä»ä¸­å­¦ä¹ åˆ°TAçš„å¦ä¸€é¢", score: 3 },
            { text: "C. åªæœ‰åœ¨äº‹åå†·é™ä¸‹æ¥æ‰ä¼šè¿™æ ·çœ‹å¾…", score: 2 },
            { text: "D. å¤šæ•°æ—¶å€™åªæ„Ÿåˆ°ä¼¤å®³å’Œç–²æƒ«", score: 1 }
        ]
    },
    {
        q: "34. ä½ ä»¬åœ¨â€œè®¤é”™â€è¿™ä»¶äº‹ä¸Šçš„ä¸»åŠ¨æ€§å¦‚ä½•ï¼Ÿ",
        options: [
            { text: "A. è°æœ‰é”™è°å…ˆé“æ­‰ï¼Œå¹¶æ‰¿æ‹…ä¿®å¤å…³ç³»çš„ä¸»åŠ¨æƒ", score: 4 },
            { text: "B. é€šå¸¸æ˜¯æ›´åœ¨ä¹å…³ç³»çš„ä¸€æ–¹å…ˆä¸»åŠ¨ç¤ºå¥½", score: 3 },
            { text: "C. åŒæ–¹éƒ½æ¯”è¾ƒå›ºæ‰§ï¼Œéœ€è¦å†·é™æœŸåæ‰è‚¯è®¤é”™", score: 2 },
            { text: "D. å¾ˆå°‘æœ‰äººä¸»åŠ¨è®¤é”™ï¼Œå¸¸äº’ç›¸åƒµæŒ", score: 1 }
        ]
    },
    {
        q: "35. å¯¹äºè¿‡å»å‘ç”Ÿçš„ã€æœªå®Œå…¨è§£å†³çš„çŸ›ç›¾ï¼Œä½ ä»¬æ˜¯ï¼Ÿ",
        options: [
            { text: "A. å·²è¢«å½»åº•æ¸…ç†å’Œæ”¾ä¸‹ï¼Œä¸å†è¢«æåŠ", score: 4 },
            { text: "B. å°‘æ•°é—ç•™ï¼Œä½†åŒæ–¹å·²è¾¾æˆä¸å†è¿½ç©¶çš„é»˜å¥‘", score: 3 },
            { text: "C. å¶å°”ä¼šè¢«ç¿»æ—§è´¦ï¼Œæˆä¸ºæ–°çš„äº‰åµå¼•çˆ†ç‚¹", score: 2 },
            { text: "D. ç»å¸¸è¢«å½“åšç­¹ç ï¼Œåœ¨äº‰åµä¸­åå¤å‡ºç°", score: 1 }
        ]
    },
    {
        q: "36. ä½ ä»¬ä¼šå¦‚ä½•å¯¹å¾…å½¼æ­¤çš„â€œåº•çº¿â€æˆ–â€œåŸåˆ™â€ï¼Ÿ",
        options: [
            { text: "A. å°†å…¶è§†ä¸ºç¥åœ£ä¸å¯ä¾µçŠ¯çš„ï¼Œæ— è®ºå¦‚ä½•éƒ½ä¼šå®ˆæŠ¤", score: 4 },
            { text: "B. ä¿æŒå°Šé‡ï¼Œä½†åœ¨ç©ç¬‘æˆ–å°äº‹ä¸Šå¶å°”ä¼šè¯•æ¢", score: 3 },
            { text: "C. åªæœ‰åœ¨è¢«æ˜ç¡®æé†’æ—¶æ‰ä¼šæƒ³èµ·å¹¶éµå®ˆ", score: 2 },
            { text: "D. ç»å¸¸å› ä¸ºè‡ªç§æˆ–å†²åŠ¨è€Œå¿½è§†å¯¹æ–¹åº•çº¿", score: 1 }
        ]
    },

    // --- 5. äº²å¯†å¥‘åˆ (37-45) ---
    {
        q: "37. åœ¨äº²å¯†äº’åŠ¨ä¸­ï¼Œä½ ä»¬å¯¹å½¼æ­¤â€œèº«ä½“è¯­è¨€â€çš„æ•æ‰èƒ½åŠ›æ˜¯ï¼Ÿ",
        options: [
            { text: "A. æé«˜ï¼Œèƒ½ä»…å‡­å¾®å°ä¿¡å·å°±ç†è§£å¯¹æ–¹çš„éœ€æ±‚", score: 4 },
            { text: "B. è‰¯å¥½ï¼Œèƒ½é€šè¿‡è‚¢ä½“æ¥è§¦å’Œç®€å•çœ¼ç¥äº¤æµç¡®è®¤", score: 3 },
            { text: "C. ä¸€èˆ¬ï¼Œéœ€è¦è¯­è¨€æ²Ÿé€šæ‰èƒ½ç¡®å®šå¯¹æ–¹çš„æ„Ÿå—", score: 2 },
            { text: "D. è¾ƒå·®ï¼Œå¸¸å¸¸åªä¸“æ³¨äºè‡ªèº«çš„æ„Ÿå—å’Œæ„‰æ‚¦", score: 1 }
        ]
    },
    {
        q: "38. ä½ ä»¬å¯¹â€œç¦å¿Œæ¢ç´¢â€æˆ–â€œç‰¹æ®Šåå¥½â€çš„å¼€æ”¾ç¨‹åº¦ï¼Ÿ",
        options: [
            { text: "A. æ„¿æ„å…±åŒæ¢ç´¢å¹¶ä¹äºå°è¯•ï¼Œå°†å…¶è§†ä¸ºå†’é™©", score: 4 },
            { text: "B. ä¿æŒå¥½å¥‡å¿ƒï¼Œä½†ä¼šè°¨æ…å¹¶æœ‰æ˜ç¡®çš„ç•Œé™", score: 3 },
            { text: "C. å¤šæ•°æ—¶å€™ä¿æŒä¼ ç»Ÿæ¨¡å¼ï¼Œåªåœ¨å®‰å…¨åŒºæ¢ç´¢", score: 2 },
            { text: "D. è®¤ä¸ºæ˜¯ä¸å¿…è¦çš„ï¼Œå¹¶ä¸¥æ ¼éµå®ˆä¼ ç»Ÿæ¨¡å¼", score: 1 }
        ]
    },
    {
        q: "39. ä½ è®¤ä¸ºä½ ä»¬åœ¨äº²å¯†å±‚é¢çš„â€œèŠ‚å¥â€æˆ–â€œåå¥½â€åŒæ­¥æ€§ï¼Ÿ",
        options: [
            { text: "A. å®Œç¾åŒæ­¥ï¼Œä»¿ä½›å¤©ç”Ÿæ³¨å®šï¼Œæ— éœ€å¤šè¨€", score: 4 },
            { text: "B. åŸºæœ¬ä¸€è‡´ï¼Œå¶æœ‰ä¸åŒä¹Ÿèƒ½å¾ˆå¿«è°ƒæ•´é€‚åº”", score: 3 },
            { text: "C. å·®å¼‚æ˜æ˜¾ï¼Œéœ€è¦ä¸€æ–¹æˆ–åŒæ–¹åšå‡ºè¾ƒå¤§å¦¥å", score: 2 },
            { text: "D. å·®å¼‚å·¨å¤§ï¼Œç»å¸¸å› èŠ‚å¥ä¸åŒè€Œæ„Ÿåˆ°ä¸åè°ƒ", score: 1 }
        ]
    },
    {
        q: "40. äº²å¯†å…³ç³»ç»“æŸåï¼Œä½ ä»¬çš„â€œä½™éŸµâ€å¤„ç†æ–¹å¼æ˜¯ï¼Ÿ",
        options: [
            { text: "A. æ·±åº¦ä¾åå’Œæƒ…æ„Ÿäº¤æµï¼Œè®©çˆ±æ„æµæ·Œ", score: 4 },
            { text: "B. ç®€å•çš„æ‹¥æŠ±å’Œç”œè¨€èœœè¯­ï¼Œè¡¨è¾¾æ»¡è¶³", score: 3 },
            { text: "C. è¿…é€Ÿåˆ†å¼€åšå„è‡ªçš„äº‹æƒ…ï¼Œæ— éœ€é¢å¤–äº¤æµ", score: 2 },
            { text: "D. æœ‰æ—¶ä¼šæ„Ÿåˆ°ä¸€ä¸å°´å°¬æˆ–ä¸æ»¡è¶³", score: 1 }
        ]
    },
    {
        q: "41. ä½ ä»¬è®¨è®ºâ€œæ€§å¥åº·â€æˆ–â€œäº²å¯†éœ€æ±‚â€æ—¶çš„å¦è¯šåº¦ï¼Ÿ",
        options: [
            { text: "A. åƒè®¨è®ºæ—¥å¸¸è¯é¢˜ä¸€æ ·è‡ªç„¶ä¸”å½»åº•", score: 4 },
            { text: "B. èƒ½å¤Ÿå¦è¯šäº¤æµï¼Œä½†ä¼šæ³¨æ„åœºåˆå’Œæªè¾", score: 3 },
            { text: "C. æœ‰ä¸€å®šçš„ä¿ç•™å’Œç¾æ¶©ï¼Œå¾ˆå°‘æ·±å…¥è®¨è®º", score: 2 },
            { text: "D. æ„Ÿåˆ°å°´å°¬ï¼Œå¤šæ•°æ—¶å€™é€šè¿‡æš—ç¤ºæ¥è¡¨è¾¾", score: 1 }
        ]
    },
    {
        q: "42. ä½ åœ¨äº²å¯†å…³ç³»ä¸­æ„Ÿåˆ°æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Ÿ",
        options: [
            { text: "A. æƒ…æ„Ÿä¸Šçš„å®Œå…¨èå…¥å’Œçµé­‚çš„è§¦ç¢°", score: 4 },
            { text: "B. èº«ä½“ä¸Šçš„é«˜åº¦å¥‘åˆå’Œæ„‰æ‚¦çš„ä½“éªŒ", score: 3 },
            { text: "C. å½¼æ­¤çš„å°Šé‡å’Œå®‰å…¨æ„Ÿçš„è¥é€ ", score: 2 },
            { text: "D. æ»¡è¶³è‡ªå·±çš„éœ€æ±‚å’Œæ¬²æœ›", score: 1 }
        ]
    },
    {
        q: "43. åœ¨äº²å¯†äº’åŠ¨æ—¶ï¼Œä½ ä»¬ä¼šäº’ç›¸èµç¾æˆ–è¡¨è¾¾è‚¯å®šå—ï¼Ÿ",
        options: [
            { text: "A. ç»å¸¸ä¸”çœŸè¯šåœ°è¡¨è¾¾å¯¹TAçš„æ¬£èµå’Œçˆ±æ„", score: 4 },
            { text: "B. ä¼šè¡¨è¾¾è‚¯å®šï¼Œä½†ä¾§é‡äºè¡Œä¸ºå’Œæ„Ÿå—", score: 3 },
            { text: "C. å¶å°”è¡¨è¾¾ï¼Œä½†å¤šæ˜¯å«è“„çš„èº«ä½“è¯­è¨€", score: 2 },
            { text: "D. å¾ˆå°‘è¡¨è¾¾ï¼Œè§‰å¾—è¿™æ˜¯ç†æ‰€å½“ç„¶çš„", score: 1 }
        ]
    },
    {
        q: "44. ä½ ä»¬åœ¨äº²å¯†å…³ç³»ä¸­ï¼Œè°æ˜¯â€œä¸»åŠ¨æ–¹â€ï¼Ÿ",
        options: [
            { text: "A. åŒæ–¹ä¼šè½®æµæ‰®æ¼”ä¸»åŠ¨æ–¹ï¼Œå……æ»¡äº’åŠ¨æ€§", score: 4 },
            { text: "B. æœ‰ä¸€ä¸ªä¸»è¦çš„å¼•å¯¼è€…ï¼Œå¦ä¸€æ–¹ä¹äºé…åˆ", score: 3 },
            { text: "C. å¤šæ•°æ—¶å€™éƒ½æ˜¯ä¸€æ–¹ä¸»åŠ¨ï¼Œå¦ä¸€æ–¹è¢«åŠ¨æ¥å—", score: 2 },
            { text: "D. å…³ç³»æ¯”è¾ƒè¢«åŠ¨ï¼Œå¸¸éœ€è¦è¢«åˆºæ¿€æ‰èƒ½å¯åŠ¨", score: 1 }
        ]
    },
    {
        q: "45. äº²å¯†å…³ç³»å¯¹ä½ ä»¬æ•´ä½“æ„Ÿæƒ…çš„æå‡ä½œç”¨æ˜¯ï¼Ÿ",
        options: [
            { text: "A. æ ¸å¿ƒé©±åŠ¨åŠ›ï¼Œæ˜¯æƒ…æ„Ÿå‡åçš„ä¸å¯æˆ–ç¼ºéƒ¨åˆ†", score: 4 },
            { text: "B. é‡è¦çš„ç²˜åˆå‰‚ï¼Œèƒ½æœ‰æ•ˆä¿®å¤æ—¥å¸¸çŸ›ç›¾", score: 3 },
            { text: "C. é”¦ä¸Šæ·»èŠ±ï¼Œæ²¡æœ‰å®ƒä¹Ÿä¸ä¼šå¯¹æ„Ÿæƒ…æœ‰å¤ªå¤§å½±å“", score: 2 },
            { text: "D. åªæ˜¯ä¾‹è¡Œå…¬äº‹ï¼Œå¯¹æƒ…æ„ŸçŠ¶æ€å½±å“è¾ƒå°", score: 1 }
        ]
    }
];

const dimNames = ["æƒ…æ„Ÿå…±æŒ¯", "æ—¥å¸¸ä»ªå¼", "æ²Ÿé€šæ·±åº¦", "å†²çªå¤„ç†", "äº²å¯†å¥‘åˆ"];

// 2. å·¨å‹å†…å®¹åº“ (æ–‡æ¡ˆå·²æ ¸å¯¹)
const contentDB = {
    results: [
        { 
            min: 85, 
            type: "high", 
            title: "ç¥çš„æ°ä½œï¼šåŒç”Ÿç«ç„°", 
            summary: "ä½ ä»¬ä¹‹é—´çš„é€‚é…åº¦å·²çªç ´äº†å¹»æƒ³çš„è¾¹ç•Œï¼Œæ˜¯ç»å¯¹æ’ä»–çš„çµé­‚å…±é¸£ã€‚ä½ ä»¬æ˜¯å½¼æ­¤åœ¨ç²¾ç¥ä¸–ç•Œé‡Œçš„å”¯ä¸€ï¼Œæ¯ä¸€åˆ»éƒ½å¤„äºå¿ƒåŠ¨çŠ¶æ€ã€‚", 
            personality: "ğŸ”’ ä¸€ä½“åŒé­‚ï¼šç¥çº§ç‹¬å ", 
            pattern: "ç»å¯¹æ’ä»–ã€ç²¾ç¥å¥‘çº¦ã€å¿ƒåŠ¨æ°¸æ’" 
        },
        { 
            min: 70, 
            type: "high", 
            title: "ç‹ç‰Œæ­æ¡£ï¼šé»˜å¥‘é¡¶é…", 
            summary: "ä½ ä»¬æ˜¯å½¼æ­¤çš„ä¸“å±å®šåˆ¶æ¬¾ã€‚ä¸éœ€è¦æ­‡æ–¯åº•é‡Œçš„æ‹‰æ‰¯ï¼Œè€Œæ˜¯ç¨³å®šçš„æƒ…ç»ªä»·å€¼å’Œæ¸…æ™°çš„è¾¹ç•Œã€‚æ˜¯æ—¥å¸¸ç”Ÿæ´»ä¸­æœ€å¯é çš„åŒå‘å¥”èµ´ã€‚", 
            personality: "ğŸ’ ä¸“å±å®šåˆ¶ï¼šé«˜æ•ˆé™ªä¼´", 
            pattern: "é«˜æ•ˆé™ªä¼´ã€åŒå‘å¥”èµ´ã€æƒ…æ„Ÿç¨³å®šå™¨" 
        },
        { 
            min: 55, 
            type: "mid", 
            title: "å¿«ä¹åˆä¼™äººï¼šäº’ç›¸é©¯æœ", 
            summary: "ä½ ä»¬çš„é€‚é…åº¦å……æ»¡å¼ åŠ›ï¼Œåƒæ˜¯â€œåˆ€å‰‘ç›¸å‘â€çš„æé™æ‹‰æ‰¯ã€‚è¿™ä»½å·®å¼‚æ˜¯ç—›è‹¦ï¼Œä¹Ÿæ˜¯å½¼æ­¤æ·±å…¥äº†è§£å’Œäº’ç›¸é©¯æœçš„åŠ¨åŠ›ã€‚", 
            personality: "âš”ï¸ åˆ€å‰‘ç›¸å‘ï¼šè™æ‹æˆé•¿", 
            pattern: "æè‡´æ‹‰æ‰¯ã€äº’ç›¸é©¯æœã€é«˜å›æŠ¥æŒ‘æˆ˜" 
        },
        { 
            min: 40, 
            type: "low", 
            title: "äº’ç›¸è¯•æ¢ï¼šèµ°é’¢ä¸é˜¶æ®µ", 
            summary: "ä½ ä»¬å°±åƒåœ¨èµ°é’¢ä¸ï¼Œæ¯ä¸€æ­¥éƒ½å……æ»¡è¯•æ¢ã€‚é€‚é…åº¦åä½ï¼Œç¼ºä¹æ ¸å¿ƒä¿¡ä»»ï¼Œæ€¥éœ€å¤§å‰‚é‡ã€é«˜è´¨é‡çš„æ²Ÿé€šæ¥å»ºç«‹å®‰å…¨æ„Ÿã€‚", 
            personality: "ğŸš§ éš”ç¦»å±éšœï¼šè°¨æ…è¯•æ¢", 
            pattern: "ä¿¡ä»»å¾…å»ºã€æƒ…ç»ªé›·åŒºã€è‡ªæˆ‘ä¿æŠ¤" 
        },
        { 
            min: 0, 
            type: "low", 
            title: "è™šç©ºç‹¬èˆï¼šäººé¬¼æƒ…æœªäº†", 
            summary: "ä½ ä»¬çš„é¢‘ç‡å®Œå…¨é”™å¼€ï¼Œè¿™æ®µå…³ç³»æ›´åƒæ˜¯ä¸€ä¸ªâ€œå¦„æƒ³é™·é˜±â€ã€‚å¤§éƒ¨åˆ†çš„çˆ±å’Œé€‚é…ï¼Œéƒ½åªå­˜åœ¨äºä½ å•æ–¹é¢çš„ç¾å¥½æœŸå¾…ä¸­ã€‚", 
            personality: "ğŸ’­ å¦„æƒ³é™·é˜±ï¼šå•å‘å¥”èµ´", 
            pattern: "é¢‘ç‡é”™å¼€ã€å•æ–¹ä»˜å‡ºã€ç—›è‹¦å¹»æƒ³" 
        }
    ],
    details: {
        high: {
            suggestions: [
                "ä¿æŒå¯¹TAçš„ä¸“å±æ„Ÿï¼Œå¶å°”æ‰“ç ´è§„åˆ™",
                "åˆ¶é€ ä¸€æ¬¡â€œç»å¯¹æ„å¤–â€çš„æƒŠå–œ",
                "å®šæœŸè¿›è¡Œâ€œå…³ç³»å¤ç›˜ä¼šè®®â€",
                "æ¯å‘¨è‡³å°‘ä¸€æ¬¡æ­£å¼çš„â€œæ„Ÿæ©å‘Šç™½â€"
            ],
            expert: "æ ¸å¿ƒä½“éªŒï¼šä½ ä»¬çš„å…³ç³»æ˜¯â€œè‡ªæˆ‘ç†æƒ³åŒ–â€çš„æœ€é«˜ä½“ç°ã€‚TAå®Œç¾å›åº”äº†ä½ å¯¹å®‰å…¨æ„Ÿã€å æœ‰æ¬²å’Œå”¯ä¸€æ€§çš„æ‰€æœ‰å¹»æƒ³ï¼Œä½“éªŒåˆ°çš„æ˜¯æè‡´çš„è¢«çˆ±å’Œè¢«æŒæ§ã€‚",
            flow: [
                {step:1, text:"æ ¹æº: ç»å¯¹å®‰å…¨åŒº"},
                {step:2, text:"è®¤çŸ¥: çµé­‚å…±é¸£"},
                {step:3, text:"æƒ…ç»ª: äº‰æ‰§å³åŠ©æ¨"},
                {step:4, text:"è¡Œä¸º: å¿ è¯šä¸å æœ‰"}
            ],
            security: [
                "åˆ¶å®šâ€œçŸ›ç›¾éš”ç¦»åè®®â€",
                "æ¯å¤©ç¡å‰10åˆ†é’Ÿéä»»åŠ¡æ€§æ‹¥æŠ±",
                "é˜²æ­¢å®Œç¾å˜æˆéº»æœ¨"
            ],
            health: { int: 98, pas: 95, com: 99, text: "æä½³çŠ¶æ€ã€‚å…³ç³»ä¸‰è§’ç¨³å›ºï¼Œæƒ…æ„Ÿæµ“åº¦æé«˜ã€‚" },
            timeline: [
                { week: "ç¬¬1å‘¨", items: ["äº’å†™ä¸€å°æ„Ÿæ©ä¿¡", "å›é¡¾3ä¸ªé«˜å…‰æ—¶åˆ»"] },
                { week: "ç¬¬2å‘¨", items: ["åˆ¶å®š3å¹´å…±åŒæ„¿æ™¯", "åŒäººæŒ‘æˆ˜æ´»åŠ¨"] },
                { week: "ç¬¬3å‘¨", items: ["ç»ƒä¹ åŒäººå†¥æƒ³", "æ·±å…¥æ¢è®¨ä»·å€¼è§‚"] },
                { week: "ç¬¬4å‘¨", items: ["ä¸ºå¯¹æ–¹åšä»¶æš–å¿ƒäº‹", "ç­–åˆ’æƒŠå–œçº¦ä¼š"] }
            ]
        },
        mid: {
            suggestions: [
                "äº«å—å†²çªåçš„é«˜æƒ…ç»ªå›æŠ¥",
                "é™åˆ¶å†²çªé¢‘ç‡ï¼Œé¿å…è€—å°½çƒ­æƒ…",
                "æ¯å‘¨ä¸€å¤©å®Œå…¨æŒ‰ä¼´ä¾£ä½œæ¯ç”Ÿæ´»",
                "å†²çªæ—¶ä½¿ç”¨â€œæˆ‘æ„Ÿè§‰...â€ä»£æ›¿æŒ‡è´£"
            ],
            expert: "æ ¸å¿ƒä½“éªŒï¼šä½ ä»¬çš„å…³ç³»æ˜¯â€œè™æ‹â€å’Œâ€œæé™å¿ƒåŠ¨â€çš„æ··åˆä½“ã€‚è™æ„Ÿåœ¨äºæ—¥å¸¸ç£¨åˆçš„ç—›è‹¦ï¼Œå¿ƒåŠ¨åœ¨äºå…‹æœç—›è‹¦åï¼Œå½¼æ­¤ä¾èµ–æ„Ÿçš„æŒ‡æ•°çº§å¢é•¿ã€‚",
            flow: [
                {step:1, text:"æ ¹æº: å·®å¼‚å³åŠ¨åŠ›"},
                {step:2, text:"è®¤çŸ¥: äº’ç›¸é©¯æœ"},
                {step:3, text:"æƒ…ç»ª: æé™æ‹‰æ‰¯"},
                {step:4, text:"è¡Œä¸º: æ‹¼å›¾æ•ˆåº”"}
            ],
            security: [
                "è­¦æƒ•æ¼”å˜æˆâ€œåå¤æ€§åˆ›ä¼¤â€",
                "æ‰¾åˆ°å…±åŒçš„â€œèˆ’é€‚åŒºâ€",
                "å‡å°‘æƒ…ç»ªçˆ†å‘"
            ],
            health: { int: 75, pas: 85, com: 60, text: "éœ‡è¡çŠ¶æ€ã€‚æ¿€æƒ…ä¸å†²çªå¹¶å­˜ï¼Œéœ€è¦å»ºç«‹æƒ…ç»ªç¼“å†²æœºåˆ¶ã€‚" },
            timeline: [
                { week: "ç¬¬1å‘¨", items: ["è®°å½•æƒ…ç»ªæ—¥è®°", "ç»ƒä¹ æš‚åœæœºåˆ¶"] },
                { week: "ç¬¬2å‘¨", items: ["ä½¿ç”¨'æˆ‘æ„Ÿåˆ°'å¥å¼", "20åˆ†é’Ÿä¸“æ³¨é™ªä¼´"] },
                { week: "ç¬¬3å‘¨", items: ["å›ºå®šçº¦ä¼šä¹‹å¤œ", "äº¤æ¢ä¸€ä¸ªç§˜å¯†"] },
                { week: "ç¬¬4å‘¨", items: ["å†²çªå24hå¤ç›˜", "åˆ¶å®šå…±åŒå°ç›®æ ‡"] }
            ]
        },
        low: {
            suggestions: [
                "æ¯å¤©å¼ºè¿«æ€§åœ°äº’ç›¸èµç¾",
                "åœæ­¢äººèº«æ”»å‡»å’Œç¿»æ—§è´¦",
                "å¯»æ‰¾å”¯ä¸€èƒ½æ”¾æ¾çš„è¯é¢˜ä½œä¸ºé”šç‚¹",
                "åè®®è¿›å…¥ä¸€ä¸ªæœˆå†·é™æœŸ (è‹¥åˆ†ä½)"
            ],
            expert: "æ ¸å¿ƒä½“éªŒï¼šä½ ä»¬çš„å…³ç³»æ˜¯â€œæ‰“ç ´æ—§æœ‰æ¨¡å¼â€çš„å…³é”®æœŸï¼Œæˆ–è€…æ˜¯â€œå¼ºçƒˆçš„æ±‚è€Œä¸å¾—â€ã€‚ä½ å¯¹ç†æƒ³çš„æŠ•å°„è¶Šå®Œç¾ï¼Œç°å®çš„è½å·®å°±è¶Šå¤§ã€‚",
            flow: [
                {step:1, text:"æ ¹æº: ä¿¡ä»»å¾…å»º"},
                {step:2, text:"è®¤çŸ¥: æƒ…ç»ªé›·åŒº"},
                {step:3, text:"æƒ…ç»ª: è‡ªæˆ‘ä¿æŠ¤"},
                {step:4, text:"è¡Œä¸º: å†…è€—ä¸¥é‡"}
            ],
            security: [
                "ç¡å‰äº’é—®å¼€æ”¾å¼é—®é¢˜",
                "å†·é™å†™ä¸‹æ„Ÿå—ç»™å¯¹æ–¹çœ‹",
                "è¯„ä¼°â€œæ²‰æ²¡æˆæœ¬â€"
            ],
            health: { int: 40, pas: 50, com: 30, text: "è­¦æˆ’çŠ¶æ€ã€‚å…¨ç»´åº¦å¤±è”é£é™©ï¼Œæ€¥éœ€å»ºç«‹æ ¸å¿ƒå®‰å…¨æ„Ÿã€‚" },
            timeline: [
                { week: "ç¬¬1å‘¨", items: ["åˆ—å‡ºä¼¤å®³æ€§ç¦è¯­", "è¿›è¡Œè‡ªæˆ‘è‚¯å®š"] },
                { week: "ç¬¬2å‘¨", items: ["ä¸»åŠ¨æ‹¥æŠ±20ç§’", "åä½œå®Œæˆå®¶åŠ¡"] },
                { week: "ç¬¬3å‘¨", items: ["é˜…è¯»ä¾æ‹ä¹¦ç±", "ç»ƒä¹ éæš´åŠ›æ²Ÿé€š"] },
                { week: "ç¬¬4å‘¨", items: ["å¯»æ±‚ä¼´ä¾£å’¨è¯¢", "é‡æ–°è¯„ä¼°è¾¹ç•Œ"] }
            ]
        }
    },
    zodiacs: {
        "Aries": { name: "ç™½ç¾Šåº§", tags: ["çƒ­æƒ…", "å†²åŠ¨"], text: "ä½ åƒç«ä¸€æ ·ç›´æ¥ï¼Œåœ¨å…³ç³»ä¸­éœ€è¦å³æ—¶åé¦ˆã€‚" },
        "Taurus": { name: "é‡‘ç‰›åº§", tags: ["ç¨³é‡", "å›ºæ‰§"], text: "ä½ é‡è§†æ„Ÿå®˜äº«å—å’Œå®‰å…¨æ„Ÿï¼Œæ…¢çƒ­ä½†é•¿æƒ…ã€‚" },
        "Gemini": { name: "åŒå­åº§", tags: ["å¤šå˜", "æœ‰è¶£"], text: "æ²Ÿé€šæ˜¯ä½ çš„å‘½é—¨ï¼Œéœ€è¦æ™ºåŠ›ä¸Šçš„åŠ¿å‡åŠ›æ•Œã€‚" },
        "Cancer": { name: "å·¨èŸ¹åº§", tags: ["æ•æ„Ÿ", "é¡¾å®¶"], text: "ä½ æœ‰ç€åšç¡¬çš„å¤–å£³å’ŒæŸ”è½¯çš„å¿ƒï¼Œæéœ€æƒ…ç»ªå®‰å…¨ã€‚" },
        "Leo": { name: "ç‹®å­åº§", tags: ["éœ¸æ°”", "å¿ è¯š"], text: "ä½ éœ€è¦è¢«å´‡æ‹œå’Œå…³æ³¨ï¼Œçˆ±å¾—çƒ­çƒˆä¸”æ…·æ…¨ã€‚" },
        "Virgo": { name: "å¤„å¥³åº§", tags: ["å®Œç¾", "ç»†èŠ‚"], text: "ä½ çš„çˆ±è—åœ¨ç»†èŠ‚é‡Œï¼Œé€šè¿‡æœåŠ¡å¯¹æ–¹æ¥è¡¨è¾¾ã€‚" },
        "Libra": { name: "å¤©ç§¤åº§", tags: ["ä¼˜é›…", "çº ç»“"], text: "ä½ è¿½æ±‚å…³ç³»çš„å’Œè°ä¸å¹³è¡¡ï¼Œå®³æ€•å†²çªã€‚" },
        "Scorpio": { name: "å¤©èåº§", tags: ["æ·±æƒ…", "å æœ‰"], text: "ä½ çš„çˆ±æ˜¯æè‡´çš„èåˆï¼Œå®¹ä¸å¾—ä¸€ä¸èƒŒå›ã€‚" },
        "Sagittarius": { name: "å°„æ‰‹åº§", tags: ["è‡ªç”±", "ä¹è§‚"], text: "ä½ éœ€è¦åƒé£ä¸€æ ·çš„è‡ªç”±ï¼Œçˆ±æ˜¯å…±åŒæ¢ç´¢ä¸–ç•Œã€‚" },
        "Capricorn": { name: "æ‘©ç¾¯åº§", tags: ["åŠ¡å®", "è´£ä»»"], text: "ä½ ç”¨è¡ŒåŠ¨ä»£æ›¿è¨€è¯­ï¼Œæ˜¯å…³ç³»ä¸­æœ€åšå®çš„ä¾é ã€‚" },
        "Aquarius": { name: "æ°´ç“¶åº§", tags: ["ç‹¬ç«‹", "ç‹¬ç‰¹"], text: "ä½ éœ€è¦ç²¾ç¥ä¸Šçš„å…±é¸£å’Œæå¤§çš„ä¸ªäººç©ºé—´ã€‚" },
        "Pisces": { name: "åŒé±¼åº§", tags: ["æµªæ¼«", "åŒ…å®¹"], text: "ä½ æ˜¯ä¸ºçˆ±è€Œç”Ÿçš„æ¢¦æƒ³å®¶ï¼Œå®¹æ˜“ä¸å¯¹æ–¹æƒ…ç»ªå…±ç”Ÿã€‚" }
    }
};

let state = {
    code: "", mode: "", info: {},
    qIdx: 0, scores: [0, 0, 0, 0, 0], totalScore: 0, answers: []
};

// é€»è¾‘æ§åˆ¶
function showView(id) {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('view-' + id).classList.add('active');
    window.scrollTo(0, 0);
}
function showAlert(msg) {
    document.getElementById('alert-msg').innerText = msg;
    document.getElementById('alert-modal').style.display = 'flex';
}
function closeModal(id) { document.getElementById(id).style.display = 'none'; }
function openModal(id) { document.getElementById(id).style.display = 'flex'; }

async function verifyCode() {
    const val = document.getElementById('code-input').value.trim();
    if(!val) return showAlert("è¯·è¾“å…¥éªŒè¯ç ");
    
    // å¦‚æœDBæœªè¿æ¥ï¼Œç”±äºæ— æ³•æ ¡éªŒï¼Œåªèƒ½æç¤ºç½‘ç»œé”™è¯¯å¹¶æ‹¦æˆªï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰
    if (!db) {
        return showAlert("æ— æ³•è¿æ¥æœåŠ¡å™¨ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ");
    }

    try {
        const { data, error } = await db.from('access_codes').select('*').eq('code', val).single();
        
        // 1. æŸ¥ä¸åˆ°æˆ–æ•°æ®åº“æŠ¥é”™
        if (error || !data) {
            return showAlert("éªŒè¯ç æ— æ•ˆæˆ–ä¸å­˜åœ¨");
        }
        
        // 2. éªŒè¯ç å·²è¢«ä½¿ç”¨ (Strict Check)
        if (data.is_used) {
            return showAlert("æ­¤éªŒè¯ç å·²å¤±æ•ˆï¼Œè¯·è·å–æ–°ç ");
        }
        
        // é€šè¿‡æ ¡éªŒ
        state.code = val;
        showView('mode');
        
    } catch(e) {
        console.error(e);
        return showAlert("éªŒè¯è¿‡ç¨‹å‡ºé”™ï¼Œè¯·é‡è¯•");
    }
}

function selectMode(m) { state.mode = m; showView('consent'); }
let agreed = false;
function toggleAgree() {
    agreed = !agreed;
    document.getElementById('agree-dot').style.display = agreed ? 'block' : 'none';
    document.getElementById('agree-radio').style.borderColor = agreed ? '#F04E6E' : '#ccc';
}
function confirmConsent() {
    if(!agreed) return showAlert("è¯·å…ˆåŒæ„åè®®");
    showView('info');
}

function selectRadio(group, val, el) {
    state.info[group] = val;
    el.parentElement.querySelectorAll('.custom-radio').forEach(d => d.classList.remove('active'));
    el.classList.add('active');
}

// ä¿®æ”¹ï¼šè·å–partnerNameè€Œéstatus
function submitInfo() {
    const zodiac = document.getElementById('zodiac-select').value;
    const name = document.getElementById('partner-name-input').value.trim();
    
    if(!state.info.age || !state.info.gender || !name || !zodiac) {
        return showAlert("è¯·å®Œæ•´å¡«å†™æ‰€æœ‰ä¿¡æ¯");
    }
    state.info.zodiac = zodiac;
    state.info.partnerName = name;
    startQuiz();
}

function startQuiz() {
    state.qIdx = 0; state.totalScore = 0; state.scores = [0,0,0,0,0];
    showView('quiz');
    renderQuestion();
}

// æ¸²æŸ“ç­”é¢˜å¡
function renderGrid() {
    const box = document.getElementById('answer-grid-box');
    if(!box) return;
    box.innerHTML = '';
    for (let i = 0; i < 45; i++) {
        const div = document.createElement('div');
        div.className = 'grid-cell';
        div.innerText = i + 1;
        if (i === state.qIdx) div.classList.add('active');
        else if (i < state.qIdx) div.classList.add('done');
        box.appendChild(div);
    }
}

// æ ¸å¿ƒæ¸²æŸ“ï¼šä» quizData ä¸­è·å–ç‰¹å®šé€‰é¡¹
function renderQuestion() {
    const idx = state.qIdx;
    const dimIdx = Math.floor(idx / 9);
    
    // ä» quizData è·å–å½“å‰é¢˜ç›®çš„æ•°æ®
    const currentQ = quizData[idx];

    document.getElementById('current-q').innerText = idx + 1;
    document.getElementById('progress-bar').style.width = ((idx / 45) * 100) + "%";
    document.getElementById('dim-name-display').innerText = dimNames[dimIdx] + "é‡è¡¨";
    document.getElementById('dim-progress-display').innerText = `ç¬¬ ${(idx % 9) + 1} / 9 é¢˜`;
    
    // æ˜¾ç¤ºé¢˜ç›®æ–‡æ¡ˆ
    document.getElementById('q-text').innerText = currentQ.q;
    
    renderGrid();

    const box = document.getElementById('options-box');
    box.innerHTML = "";
    document.getElementById('btn-next').disabled = true;

    // éå†å½“å‰é¢˜ç›®çš„ options
    currentQ.options.forEach((opt) => {
        const div = document.createElement('div');
        div.className = 'option-item';
        // æ˜¾ç¤ºå…·ä½“çš„é€‰é¡¹æ–‡æœ¬
        div.innerHTML = `<div class="option-circle"></div><div style="font-size:15px;">${opt.text}</div>`;
        div.onclick = () => {
            box.querySelectorAll('.option-item').forEach(d => d.classList.remove('selected'));
            div.classList.add('selected');
            state.answers[idx] = opt.score;
            document.getElementById('btn-next').disabled = false;
            setTimeout(() => nextQuestion(), 250);
        };
        box.appendChild(div);
    });
    document.getElementById('btn-prev').style.visibility = idx === 0 ? 'hidden' : 'visible';
}

function nextQuestion() {
    const score = state.answers[state.qIdx];
    if(!score) return;
    const dimIdx = Math.floor(state.qIdx / 9);
    state.scores[dimIdx] += score;
    state.totalScore += score;

    if(state.qIdx < 44) {
        state.qIdx++;
        renderQuestion();
    } else {
        finishQuiz();
    }
}

function prevQuestion() {
    if(state.qIdx > 0) {
        const prevScore = state.answers[state.qIdx - 1];
        const dimIdx = Math.floor((state.qIdx - 1) / 9);
        state.scores[dimIdx] -= prevScore;
        state.totalScore -= prevScore;
        state.qIdx--;
        renderQuestion();
    }
}

function finishQuiz() { 
    if (db && state.code) {
        try { 
            db.from('access_codes').update({is_used: true}).eq('code', state.code).then(({ error }) => {
                if(error) console.error("æ ¸é”€å¤±è´¥", error);
            }); 
        } catch(e) { console.error("æ ¸é”€å¼‚å¸¸", e); }
    }
    renderResult(); 
}

function renderResult() {
    showView('result');
    window.scrollTo(0, 0);

    let final = Math.round((state.totalScore - 45) / 135 * 100);
    if(isNaN(final) || final < 0) final = 0; if(final > 100) final = 100;
    
    const resData = contentDB.results.find(r => final >= r.min) || contentDB.results[4];
    const details = contentDB.details[resData.type];

    try {
        // NEW: æ˜¾ç¤ºæˆ‘å’ŒTaçš„åå­—
        const partnerName = state.info.partnerName || "Ta";
        document.getElementById('res-names').innerText = `æˆ‘ & ${partnerName}`;

        document.getElementById('res-score').innerText = final;
        document.getElementById('res-level').innerText = resData.title;
        document.getElementById('res-summary').innerText = resData.summary;
        setTimeout(() => { 
            const slider = document.getElementById('res-slider');
            if(slider) slider.style.left = final + "%"; 
        }, 500);
    } catch(e) { console.error("Header Error", e); }

    try {
        if (details && details.suggestions) {
            document.getElementById('box-suggestions').innerHTML = details.suggestions.map(s => 
                `<div class="list-box"><div class="list-icon-bg"><i class="fas fa-check"></i></div><div style="font-size:13px;">${s}</div></div>`
            ).join('');
        }
    } catch(e) { console.error("Suggest Error", e); }

    try {
        const dimBox = document.getElementById('box-dimensions');
        if(dimBox) {
            dimBox.innerHTML = "";
            dimNames.forEach((n, i) => {
                let dVal = Math.round((state.scores[i] - 9) / 27 * 100);
                if(dVal < 0) dVal = 0;
                dimBox.innerHTML += `
                    <div class="capsule"><div style="flex:1;">
                        <div style="display:flex; justify-content:space-between; font-size:12px; font-weight:bold;"><span>${n}</span><span>${dVal}åˆ†</span></div>
                        <div class="capsule-bar"><div class="progress-fill" style="width:${dVal}%"></div></div>
                    </div></div>`;
            });
        }
    } catch(e) { console.error("Dim Error", e); }

    try {
        if(details) {
            document.getElementById('box-personality').innerHTML = `<h3 style="color:var(--primary);margin-bottom:5px;">${resData.personality}</h3><p style="font-size:12px;color:#666;">åŸºäºä½œç­”æ¨¡å¼åˆ†æ</p>`;
            document.getElementById('box-patterns').innerHTML = `<div class="list-box"><div class="list-icon-bg"><i class="fas fa-sync"></i></div><div><h4>${resData.pattern}</h4><p style="font-size:12px;color:#666;">å½“å‰æ˜¾è‘—äº’åŠ¨ç‰¹å¾</p></div></div>`;
            document.getElementById('box-expert').innerHTML = `<p style="font-size:13px;color:#555;">${details.expert}</p>`;
            document.getElementById('box-flow').innerHTML = details.flow.map((f, i) => `<div style="background:#f9f9f9;padding:10px;margin-bottom:5px;border-radius:8px;font-size:12px;"><strong>${f.text.split(':')[0]}</strong>: ${f.text.split(':')[1]}</div>`).join('');
            document.getElementById('box-security').innerHTML = details.security.map(s => `<div class="list-box"><div class="list-icon-bg" style="background:#E3F2FD;color:#2196F3;"><i class="fas fa-shield-alt"></i></div><div style="font-size:13px;">${s}</div></div>`).join('');
            
            const h = details.health;
            document.getElementById('box-health').innerHTML = `
                <div class="capsule"><div style="flex:1;"><div style="display:flex; justify-content:space-between; font-size:10px;"><span>äº²å¯†</span><span>${h.int}%</span></div><div class="capsule-bar"><div class="progress-fill" style="width:${h.int}%; background:#33691E;"></div></div></div></div>
                <div class="capsule"><div style="flex:1;"><div style="display:flex; justify-content:space-between; font-size:10px;"><span>æ¿€æƒ…</span><span>${h.pas}%</span></div><div class="capsule-bar"><div class="progress-fill" style="width:${h.pas}%; background:#33691E;"></div></div></div></div>
            `;
            document.getElementById('text-health-summary').innerText = h.text;
            
            document.getElementById('box-timeline').innerHTML = details.timeline.map(t => 
                `<div style="position:relative; padding-left:20px; margin-bottom:20px; border-left:2px solid #eee;">
                    <div style="font-weight:bold;font-size:14px;color:var(--primary);">${t.week}</div>
                    ${t.items.map(i=>`<div style="font-size:12px;color:#555;">â€¢ ${i}</div>`).join('')}
                </div>`
            ).join('');
        }
    } catch(e) { console.error("Text Error", e); }

    try {
        const userZodiac = state.info.zodiac || "Aries"; 
        const zData = contentDB.zodiacs[userZodiac];
        if(zData) {
            document.getElementById('box-zodiac').innerHTML = `
                <div style="text-align:center;">
                    <h3 style="color:var(--purple-text);">${zData.name}</h3>
                    <div style="margin:10px 0;">${zData.tags.map(t=>`<span style="font-size:10px;background:white;padding:4px 8px;border-radius:10px;margin:2px;color:var(--purple-text);">${t}</span>`).join('')}</div>
                    <p style="font-size:12px;color:var(--purple-text);opacity:0.8;">${zData.text}</p>
                </div>`;
        }
    } catch(e) { console.error("Zodiac Error", e); }

    document.getElementById('session-id').innerText = Math.random().toString(36).substr(2, 9).toUpperCase();
    document.getElementById('finish-time').innerText = new Date().toLocaleDateString();

    try {
        const ctx = document.getElementById('radarChart');
        if(window.myRadar) window.myRadar.destroy();
        if(typeof Chart !== 'undefined' && ctx) {
            window.myRadar = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: dimNames,
                    datasets: [{
                        label: 'å¾—åˆ†',
                        data: state.scores.map(s => (s-9)/27*100),
                        backgroundColor: 'rgba(240, 78, 110, 0.2)',
                        borderColor: '#F04E6E',
                        pointBackgroundColor: '#F04E6E'
                    }]
                },
                options: {
                    scales: { r: { min: 0, max: 100, ticks: { display: false } } },
                    plugins: { legend: { display: false } }
                }
            });
        }
    } catch(e) { console.error("Chart Error", e); }
}

function generatePoster() {
    const modal = document.getElementById('share-modal');
    openModal('share-modal');
    document.getElementById('poster-loading').style.display = 'block';
    document.getElementById('poster-img').style.display = 'none';
    document.getElementById('poster-tip').style.display = 'none';
    document.querySelector('.bottom-bar').style.display = 'none';
    window.scrollTo(0,0);

    setTimeout(() => {
        html2canvas(document.querySelector("#view-result"), {
            scale: 2, useCORS: true, allowTaint: true, scrollY: 0, backgroundColor: '#FAFAFA',
            onclone: (clonedDoc) => {
                const c = clonedDoc.getElementById('view-result');
                c.classList.add('snapshot-mode');
                c.style.height = 'auto';
                c.style.overflow = 'visible';
            }
        }).then(canvas => {
            document.getElementById('poster-img').src = canvas.toDataURL("image/png");
            document.getElementById('poster-loading').style.display = 'none';
            document.getElementById('poster-img').style.display = 'block';
            document.getElementById('poster-tip').style.display = 'flex';
            document.querySelector('.bottom-bar').style.display = 'flex';
        }).catch(err => {
            console.error(err);
            document.getElementById('poster-loading').innerText = "ç”Ÿæˆå¤±è´¥ï¼Œè¯·æˆªå±åˆ†äº«";
            document.querySelector('.bottom-bar').style.display = 'flex';
        });
    }, 500);
}